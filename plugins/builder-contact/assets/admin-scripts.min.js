var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,c){a instanceof String&&(a=String(a));for(var b=a.length,d=0;d<b;d++){var f=a[d];if(e.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,c){a!=Array.prototype&&a!=Object.prototype&&(a[e]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,c,b){if(e){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var d=a[b];d in c||(c[d]={});c=c[d]}a=a[a.length-1];b=c[a];e=e(b);e!=b&&null!=e&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
(function(a){var e=function(c){this.$table=a(c);this.init()};e.prototype={init:function(){this.loadExtraFields();this.loadOrders();this.makeSortable();this.events()},loadOrders:function(){var c=this,b=this.$table.find("tbody tr").sort(function(b,c){var d=a(b).find(".tb_lb_option").attr("id"),e=a(c).find(".tb_lb_option").attr("id"),d=void 0===d?a(b).find(".tb-new-field-textbox").val():d,e=void 0===e?a(c).find(".tb-new-field-textbox").val():e;try{var f=JSON.parse(a("#field_order").val())}catch(l){}f||
(f={});return f[d]-f[e]});a.each(b,function(a,b){c.$table.find("tbody").append(b)})},loadExtraFields:function(){var c=this,b=a(".tb-new-field-row");try{var d=JSON.parse(a("#field_extra").val())}catch(k){}d||(d={fields:[]});var e=a("#tmpl-builder-contact-new-field").length?a("#tmpl-builder-contact-new-field").html():a("#themify_builder_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field").html();_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,
escape:/\{\{([^\}]+?)\}\}(?!\})/g};_.each(d.fields,function(f,h){var g=_.template(e,{variable:"data"});f.index=++h;d.id=c.$table.find(".tb-contact-new-row").length++;d.field=f;a(g(d)).insertBefore(b)})},events:function(){var c=this;this.$table.on("click",".tb-new-field-action",function(a){a.preventDefault();c.addField(this)}).on("change",'input[name*="tb-new-field-type-"]',function(){c.switchField(this)}).on("click",".tb-add-field-option",function(b){b.preventDefault();a(this).siblings("ul").append('<li><input type="text" class="tb-multi-option"><a href="#" class="tb-contact-value-remove"><i class="ti ti-close"></i></a></li>')}).on("change",
".tb-multi-option",function(){c.setNames()}).on("keyup",'.tb-contact-new-row input[type="text"]',function(){c.changeObject()}).on("change",".tb-contact-new-row .tb-new-field-required",function(){c.changeObject()}).on("click",".tb-contact-value-remove",function(b){b.preventDefault();a(this).closest("li").remove();c.changeObject()}).on("click",".tb-contact-field-remove",function(b){b.preventDefault();a(this).closest("tr").remove();c.changeObject()})},setNames:function(){this.$table.find(".tb-multi-option").each(function(c){var b=
a(this).closest("tr").find(".tb-new-field-textbox").val(),b=b.toLowerCase(),b=b.replace(/ /g,"_");a(this).attr("name",b+"_"+c).attr("id",b+"_"+c)})},makeSortable:function(){var a=this;this.$table.find("tbody").sortable({items:"tr:not(.tb-new-field-row)",placeholder:"ui-state-highlight",update:function(){a.changeObject();a.sort()}}).disableSelection()},sort:function(){var c={};a(".contact_fields tr").each(function(){var b=a(this).find(".tb_lb_option").attr("id");b||(b=a(this).find(".tb-new-field-textbox").val());
c[b]=a(this).index()});a("#field_order").val(JSON.stringify(c));Themify.triggerEvent(a("#field_order").get(0),"keyup")},addField:function(c){var b=a(c),d={};c=b.closest("tr");b=b.closest("tbody");var e=a("#tmpl-builder-contact-new-field").length?a("#tmpl-builder-contact-new-field").html():a("#themify_builder_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field").html();_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};
e=_.template(e,{variable:"data"});d.id=b.find(".tb-contact-new-row").length++;d=a(e(d));d.insertBefore(c);d.find('input[name*="tb-new-field-type-"]:checked').trigger("keyup");b.sortable("refresh");this.changeObject()},switchField:function(c){var b=a(c).val();a(c).closest(".tb-new-field-type").next().find(".control-input").html(this.fieldUI(b))},fieldUI:function(c,b){switch(c){case "text":case "textarea":var d=a('<input type="text" placeholder="Placeholder" class="tb-new-field-value tb-field-type-'+
c+'">');break;case "radio":case "select":case "checkbox":d=a("#tmpl-builder-contact-new-field-options").length?a("#tmpl-builder-contact-new-field-options").html():a("#themify_builder_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field-options").html(),_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},d=_.template(d,{variable:"data"}),b||(b={type:c,fields:[""]}),d=a(d(b))}this.changeObject();return d},changeObject:function(){var c=
{fields:[]};this.$table.find(".tb-contact-new-row").each(function(){var b=a(this),d=b.find('input[name*="tb-new-field-type-"]:checked').val(),e=b.index(),k=b.find(".tb-new-field-textbox").val(),h=b.find(".tb-new-field-required").is(":checked");switch(d){case "text":case "textarea":var g=b.find(".tb-new-field-value").val();break;case "radio":case "select":case "checkbox":g=[],b.find(".tb-multi-option").each(function(){g.push(a(this).val())})}c.fields.push({order:e,type:d,label:k,value:g,required:h})});
this.$table.find("#field_extra").val(JSON.stringify(c));Themify.triggerEvent(this.$table.find("#field_extra").get(0),"keyup");this.sort()}};a("body").on("editing_module_option",function(){setTimeout(function(){new e(".contact_fields")},10)})})(jQuery);
